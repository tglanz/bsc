digraph G {

    rankdir=LR;

    X [label=<<b>X</b><br/>shape=(N, M)>];
    Y [label=<<b>X</b><br/>shape=(N, M)>];

    subgraph cluster_1 {
        label = "SplitLayer NxM"

        Split [label=<<b>Split</b><br/> size=M/2, dim=1>, shape=box];
        X1;
        X2;

        Linear [label=<<b>Linear</b><br/>in=M/2, out=M/2>, shape=box];
        Relu [shape=box];
        Concat [label=<<b>Concat</b><br/>dim=1>, shape=box];

        Linear -> Relu [color=red]
        Linear -> Relu [color=blue];
    }
    
    X -> Split;

    Split -> X1 [color=red];
    Split -> X2 [color=blue]; 

    X1 -> Linear  [color=red];
    X2 -> Linear [color=blue];    

    Relu -> Concat [color=red];
    Relu -> Concat [color=blue];

    Concat -> Y;
}
